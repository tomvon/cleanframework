// Form Component

.form {
    max-width: 600px;
    margin: 2rem auto;
    
    .group {
        margin-bottom: 1rem;
    }
    
    label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: var(--muted-foreground);
    }
    
    input,
    textarea {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--border);
        border-radius: var(--radius);
        font-size: 1rem;
        background: var(--input);
        color: var(--foreground);
        transition: border-color 0.2s ease;
        
        &:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary), transparent 80%);
        }
    }
    
    // Custom select styling
    select {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        width: 100%;
        padding: 0.75rem 2.5rem 0.75rem 0.75rem;
        border: 2px solid var(--border);
        border-radius: var(--radius);
        font-size: 1rem;
        background-color: var(--input);
        color: var(--foreground);
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%233B82F6' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 0.75rem center;
        background-size: 1rem;
        cursor: pointer;
        transition: all 0.15s ease;
        
        &:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary), transparent 80%);
        }
        
        &:hover {
            border-color: var(--primary);
            background-color: color-mix(in srgb, var(--primary), transparent 97%);
        }
        
        // Custom arrow for different states
        &:focus,
        &:active {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23059669' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
        }
        
        // Remove default arrow in IE
        &::-ms-expand {
            display: none;
        }
    }
    
    // Checkbox and radio styling - fully custom with appearance: none
    input[type="checkbox"],
    input[type="radio"] {
        -webkit-appearance: none;
        appearance: none;
        background-color: var(--input);
        margin: 0;
        margin-right: 0.75rem;
        font: inherit;
        color: var(--primary);
        width: 1.5em;
        height: 1.5em;
        border: 0.15em solid var(--primary);
        cursor: pointer;
        display: inline-grid;
        place-content: center;
        transition: all 0.15s ease;
        
        &:focus {
            outline: max(2px, 0.15em) solid var(--primary);
            outline-offset: max(2px, 0.15em);
        }
        
        &:hover {
            background-color: color-mix(in srgb, var(--primary), transparent 95%);
            transform: scale(1.05);
        }
        
        &:checked {
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        &:checked:hover {
            background-color: color-mix(in srgb, var(--primary), black 10%);
            border-color: color-mix(in srgb, var(--primary), black 10%);
        }
    }
    
    // Checkbox checkmark
    input[type="checkbox"] {
        border-radius: calc(var(--radius) / 2);
        
        &::before {
            content: "";
            width: 0.65em;
            height: 0.65em;
            transform: scale(0);
            transition: 120ms transform ease-in-out;
            background-color: var(--card);
            clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
        }
        
        &:checked::before {
            transform: scale(1);
        }
    }
    
    // Radio button dot
    input[type="radio"] {
        border-radius: 50%;
        
        &::before {
            content: "";
            width: 0.65em;
            height: 0.65em;
            border-radius: 50%;
            transform: scale(0);
            transition: 120ms transform ease-in-out;
            background-color: var(--card);
        }
        
        &:checked::before {
            transform: scale(1);
        }
    }
    
    // Range slider styling - fully custom
    input[type="range"] {
        -webkit-appearance: none;
        appearance: none;
        background: transparent;
        cursor: pointer;
        width: 100%;
        height: 1.5rem;
        padding: 0;
        margin: 0.5rem 0;
        
        // Track styling
        &::-webkit-slider-track {
            width: 100%;
            height: 0.5rem;
            background: var(--muted);
            border-radius: 0.5rem;
            border: none;
        }
        
        &::-moz-range-track {
            width: 100%;
            height: 0.5rem;
            background: var(--muted);
            border-radius: 0.5rem;
            border: none;
        }
        
        // Thumb styling
        &::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 1.5rem;
            width: 1.5rem;
            border-radius: 50%;
            background: var(--primary);
            border: 3px solid var(--card);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.15s ease;
            
            &:hover {
                background: color-mix(in srgb, var(--primary), black 10%);
                transform: scale(1.1);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }
        }
        
        &::-moz-range-thumb {
            height: 1.5rem;
            width: 1.5rem;
            border-radius: 50%;
            background: var(--primary);
            border: 3px solid var(--card);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.15s ease;
            
            &:hover {
                background: color-mix(in srgb, var(--primary), black 10%);
                transform: scale(1.1);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }
        }
        
        &:focus {
            outline: none;
            
            &::-webkit-slider-thumb {
                box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary), transparent 80%), 0 2px 6px rgba(0, 0, 0, 0.2);
            }
            
            &::-moz-range-thumb {
                box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary), transparent 80%), 0 2px 6px rgba(0, 0, 0, 0.2);
            }
        }
    }
    
    // Color input styling
    input[type="color"] {
        width: 50px;
        height: 40px;
        padding: 2px;
        border: 1px solid var(--border);
        cursor: pointer;
        
        &::-webkit-color-swatch {
            border: none;
            border-radius: calc(var(--radius) - 2px);
        }
        
        &::-moz-color-swatch {
            border: none;
            border-radius: calc(var(--radius) - 2px);
        }
    }
    
    // Search input styling
    input[type="search"] {
        padding-left: 2.5rem;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236B7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3ccircle cx='11' cy='11' r='8'%3e%3c/circle%3e%3cpath d='m21 21-4.35-4.35'%3e%3c/path%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: left 0.75rem center;
        background-size: 1rem;
        
        &::-webkit-search-cancel-button {
            -webkit-appearance: none;
            appearance: none;
            height: 1rem;
            width: 1rem;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236B7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cline x1='18' y1='6' x2='6' y2='18'%3e%3c/line%3e%3cline x1='6' y1='6' x2='18' y2='18'%3e%3c/line%3e%3c/svg%3e");
            background-size: 1rem;
            cursor: pointer;
            margin-left: 0.5rem;
        }
    }
    
    // Time and datetime inputs
    input[type="time"],
    input[type="datetime-local"],
    input[type="week"],
    input[type="month"] {
        cursor: pointer;
        
        &::-webkit-calendar-picker-indicator {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%233B82F6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3crect x='3' y='4' width='18' height='15' rx='2' ry='2'%3e%3c/rect%3e%3cline x1='16' y1='2' x2='16' y2='6'%3e%3c/line%3e%3cline x1='8' y1='2' x2='8' y2='6'%3e%3c/line%3e%3cline x1='3' y1='10' x2='21' y2='10'%3e%3c/line%3e%3c/svg%3e");
            background-size: 1rem;
            cursor: pointer;
            opacity: 0.7;
            
            &:hover {
                opacity: 1;
            }
        }
    }
    
    // Password input with toggle
    .password-field {
        position: relative;
        
        input[type="password"],
        input[type="text"].password-input {
            padding-right: 2.5rem;
        }
        
        .password-toggle {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.25rem;
            color: var(--gray-500);
            transition: color 0.15s ease;
            
            &:hover {
                color: var(--primary);
            }
            
            svg {
                width: 1rem;
                height: 1rem;
                
                &.eye-closed {
                    display: none;
                }
                
                &.hidden {
                    display: none;
                }
            }
        }
    }
    
    // File input styling
    input[type="file"] {
        padding: 0.5rem;
        background: var(--muted);
        
        &::file-selector-button {
            background: var(--primary);
            color: var(--card);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            margin-right: 1rem;
            cursor: pointer;
            font-size: 0.875rem;
            
            &:hover {
                background: color-mix(in srgb, var(--primary), black 10%);
            }
        }
        
        &::-webkit-file-upload-button {
            background: var(--primary);
            color: var(--card);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            margin-right: 1rem;
            cursor: pointer;
            font-size: 0.875rem;
            
            &:hover {
                background: color-mix(in srgb, var(--primary), black 10%);
            }
        }
    }
    
    textarea {
        resize: vertical;
        min-height: 120px;
    }
    
    .error {
        color: var(--danger);
        font-size: 0.875rem;
        margin-top: 0.25rem;
    }
    
    .help {
        color: var(--muted-foreground);
        font-size: 0.875rem;
        margin-top: 0.25rem;
    }
    
    // Group styling for checkboxes and radios
    .options {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        
        .option {
            display: flex;
            align-items: center;
            cursor: pointer;
            
            input {
                margin-right: 0.75rem;
                margin-bottom: 0;
            }
            
            label {
                font-weight: normal;
                color: var(--foreground);
                cursor: pointer;
                margin-bottom: 0;
            }
        }
    }
    
    .group.inline {
        .options {
            flex-direction: row;
            flex-wrap: wrap;
            gap: 1rem;
        }
    }
    
    // Number input with step buttons styling
    input[type="number"] {
        &::-webkit-inner-spin-button,
        &::-webkit-outer-spin-button {
            opacity: 1;
        }
    }
    
    .range-display {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 0.5rem;
        font-size: 0.875rem;
        color: var(--muted-foreground);
        
        .current-value {
            font-weight: 600;
            color: var(--primary);
            padding: 0.25rem 0.5rem;
            background: color-mix(in srgb, var(--primary), transparent 90%);
            border-radius: calc(var(--radius) / 2);
        }
    }
    
    // Fieldset and legend styling
    fieldset {
        border: 2px solid var(--border);
        border-radius: var(--radius);
        padding: 1rem;
        margin-bottom: 1.5rem;
        
        legend {
            font-weight: 600;
            color: var(--foreground);
            padding: 0 0.5rem;
            background: var(--background);
        }
    }
    
    // Enhanced file upload (drag & drop area)
    .file-upload-area {
        border: 2px dashed var(--border);
        border-radius: var(--radius);
        padding: 2rem;
        text-align: center;
        background: var(--muted);
        transition: all 0.2s ease;
        cursor: pointer;
        position: relative;
        
        &:hover {
            border-color: var(--primary);
            background: color-mix(in srgb, var(--primary), transparent 97%);
        }
        
        &.dragover {
            border-color: var(--primary);
            background: color-mix(in srgb, var(--primary), transparent 95%);
            transform: scale(1.02);
        }
        
        &.has-files {
            padding: 1rem;
            border-style: solid;
            border-color: var(--primary);
            background: color-mix(in srgb, var(--primary), transparent 98%);
        }
        
        .upload-icon {
            font-size: 2rem;
            color: var(--gray-400);
            margin-bottom: 1rem;
        }
        
        .upload-text {
            color: var(--gray-600);
            margin-bottom: 0.5rem;
        }
        
        .upload-hint {
            font-size: 0.875rem;
            color: var(--gray-500);
        }
        
        input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
            z-index: 1;
        }
        
        &.has-files input[type="file"] {
            pointer-events: none;
            z-index: 0;
        }
        
        .file-previews {
            margin-top: 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 1rem;
            position: relative;
            z-index: 2;
            
            .file-preview {
                position: relative;
                border-radius: var(--radius);
                overflow: hidden;
                background: var(--card);
                border: 1px solid var(--border);
                transition: transform 0.2s ease;
                z-index: 3;
                
                &:hover {
                    transform: scale(1.05);
                    box-shadow: var(--shadow);
                }
                
                .preview-image {
                    width: 100%;
                    height: 100px;
                    object-fit: cover;
                    border-radius: calc(var(--radius) - 1px) calc(var(--radius) - 1px) 0 0;
                    position: relative;
                    z-index: 1;
                }
                
                .preview-file {
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    height: 100px;
                    padding: 0.5rem;
                    background: var(--muted);
                    position: relative;
                    z-index: 1;
                    
                    .file-icon {
                        font-size: 2rem;
                        color: var(--primary);
                        margin-bottom: 0.5rem;
                    }
                }
                
                .file-info {
                    padding: 0.5rem;
                    text-align: center;
                    position: relative;
                    z-index: 2;
                    
                    .file-name {
                        font-size: 0.75rem;
                        font-weight: 500;
                        color: var(--card-foreground);
                        margin-bottom: 0.25rem;
                        word-break: break-word;
                        display: -webkit-box;
                        -webkit-line-clamp: 2;
                        -webkit-box-orient: vertical;
                        overflow: hidden;
                    }
                    
                    .file-size {
                        font-size: 0.625rem;
                        color: var(--muted-foreground);
                    }
                }
                
                .remove-file {
                    position: absolute;
                    top: 0.25rem;
                    right: 0.25rem;
                    width: 1.5rem;
                    height: 1.5rem;
                    border-radius: 50%;
                    background: rgba(0, 0, 0, 0.7);
                    color: var(--card);
                    border: none;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 0.75rem;
                    transition: background-color 0.2s ease;
                    z-index: 10;
                    pointer-events: auto;
                    
                    &:hover {
                        background: var(--danger);
                    }
                }
            }
        }
        
        .upload-actions {
            margin-top: 1rem;
            display: none;
            gap: 0.5rem;
            justify-content: center;
            position: relative;
            z-index: 5;
            
            &.visible {
                display: flex;
            }
            
            .clear-all {
                background: var(--danger);
                color: var(--card);
                border: none;
                padding: 0.5rem 1rem;
                border-radius: var(--radius);
                cursor: pointer;
                font-size: 0.875rem;
                transition: background-color 0.2s ease;
                z-index: 10;
                position: relative;
                pointer-events: auto;
                
                &:hover {
                    background: color-mix(in srgb, var(--danger), black 10%);
                }
            }
        }
    }
    
    // Multi-select styling
    select[multiple] {
        min-height: 120px;
        background-image: none;
        padding: 0.5rem;
        
        option {
            padding: 0.5rem;
            border-radius: calc(var(--radius) / 2);
            margin-bottom: 0.25rem;
            
            &:checked {
                background: var(--primary);
                color: var(--white);
            }
        }
    }
    
    // Input groups (prefix/suffix)
    .input-group {
        display: flex;
        align-items: stretch;
        
        .input-prefix,
        .input-suffix {
            background: var(--muted);
            border: 1px solid var(--border);
            padding: 0.75rem;
            display: flex;
            align-items: center;
            font-weight: 500;
            color: var(--muted-foreground);
            white-space: nowrap;
        }
        
        .input-prefix {
            border-right: none;
            border-radius: var(--radius) 0 0 var(--radius);
        }
        
        .input-suffix {
            border-left: none;
            border-radius: 0 var(--radius) var(--radius) 0;
        }
        
        input {
            border-radius: 0;
            
            &:first-child {
                border-radius: var(--radius) 0 0 var(--radius);
            }
            
            &:last-child {
                border-radius: 0 var(--radius) var(--radius) 0;
            }
            
            &:only-child {
                border-radius: var(--radius);
            }
        }
        
        .input-prefix + input {
            border-left: none;
        }
        
        input + .input-suffix {
            border-left: none;
        }
    }
    
    // Toggle switch (alternative to checkbox)
    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 3rem;
        height: 1.5rem;
        margin-right: 0.75rem;
        
        input[type="checkbox"] {
            opacity: 0;
            width: 0;
            height: 0;
            margin: 0;
            
            &:checked + .toggle-slider {
                background-color: var(--primary);
                
                &::before {
                    transform: translateX(1.5rem);
                }
            }
            
            &:focus + .toggle-slider {
                box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary), transparent 80%);
            }
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--muted);
            transition: 0.2s ease;
            border-radius: 1.5rem;
            
            &::before {
                position: absolute;
                content: "";
                height: 1.25rem;
                width: 1.25rem;
                left: 0.125rem;
                bottom: 0.125rem;
                background-color: var(--card);
                transition: 0.2s ease;
                border-radius: 50%;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            }
        }
    }
    
    // Star rating component
    .star-rating {
        display: flex;
        gap: 0.25rem;
        margin-right: 0.75rem;
        
        input[type="radio"] {
            display: none;
        }
        
        label {
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--muted);
            transition: color 0.15s ease;
            
            &:hover,
            &:hover ~ label {
                color: var(--yellow-400);
            }
        }
        
        input:checked ~ label {
            color: var(--yellow-400);
        }
        
        // Reverse the order for proper star highlighting
        &:hover {
            label {
                color: var(--muted);
                
                &:hover {
                    color: var(--yellow-400);
                }
            }
        }
    }
    
    // Progress indicator for multi-step forms
    .form-progress {
        background: var(--muted);
        border-radius: var(--radius);
        padding: 1rem;
        margin-bottom: 2rem;
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
            position: relative;
            
            &::before {
                content: '';
                position: absolute;
                top: 1rem;
                left: 1rem;
                right: 1rem;
                height: 2px;
                background: var(--border);
                z-index: 1;
            }
            
            .progress-fill {
                position: absolute;
                top: 1rem;
                left: 1rem;
                height: 2px;
                background: var(--primary);
                z-index: 2;
                transition: width 0.3s ease;
            }
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 3;
            
            .step-circle {
                width: 2rem;
                height: 2rem;
                border-radius: 50%;
                background: var(--muted);
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: 600;
                color: var(--muted-foreground);
                transition: all 0.3s ease;
            }
            
            .step-label {
                font-size: 0.75rem;
                margin-top: 0.5rem;
                color: var(--muted-foreground);
                text-align: center;
            }
            
            &.active .step-circle {
                background: var(--primary);
                color: var(--card);
            }
            
            &.completed .step-circle {
                background: var(--secondary);
                color: var(--card);
                
                &::after {
                    content: "✓";
                }
            }
        }
    }
}

// Multi-step form
.form-multi {
    max-width: 800px;
    margin: 2rem auto;
    
    .progress {
        margin-bottom: 2rem;
        
        .bar {
            height: 8px;
            background: var(--muted);
            border-radius: 999px;
            overflow: hidden;
            
            .fill {
                height: 100%;
                background: var(--primary);
                transition: width 0.3s ease;
            }
        }
        
        .steps {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            
            .step {
                text-align: center;
                flex: 1;
                
                .number {
                    width: 2rem;
                    height: 2rem;
                    background: var(--muted);
                    color: var(--muted-foreground);
                    border-radius: 50%;
                    display: inline-flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: 600;
                    font-size: 0.875rem;
                    margin-bottom: 0.5rem;
                    transition: all 0.3s ease;
                }
                
                .label {
                    font-size: 0.875rem;
                    color: var(--muted-foreground);
                }
                
                &.active .number {
                    background: var(--primary);
                    color: var(--card);
                }
                
                &.completed .number {
                    background: var(--secondary);
                    color: var(--card);
                    
                    &:after {
                        content: "✓";
                    }
                }
            }
        }
    }
    
    .nodes {
        position: relative;
        min-height: 300px;
    }
    
    .node {
        display: none;
        animation: fadeIn 0.3s ease;
        
        &.active {
            display: block;
        }
        
        .title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--foreground);
        }
        
        .description {
            color: var(--muted-foreground);
            margin-bottom: 2rem;
        }
    }
    
    .navigation {
        display: flex;
        justify-content: space-between;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 1px solid var(--border);
        
        .left, .right {
            display: flex;
            gap: 1rem;
        }
        
        // Initially hide previous button and submit button
        .left button {
            &:first-child {
                display: none;
                
                &.visible {
                    display: inline-block;
                }
            }
        }
        
        .right button[type="submit"] {
            display: none;
            
            &.visible {
                display: inline-block;
            }
        }
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateX(20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

// Responsive forms
@media (max-width: 768px) {
    .form,
    .form-multi {
        max-width: 100%;
    }
    
    .form-multi {
        .progress .steps {
            .step .label {
                display: none;
            }
        }
        
        .navigation {
            flex-direction: column-reverse;
            gap: 1rem;
            
            .left, .right {
                width: 100%;
                justify-content: center;
            }
        }
    }
}